package rules.beer;
dialect  "mvel"

import brewbuddy.models.Beer;
import brewbuddy.models.UserBeerLogger;
import brewbuddy.models.User;

global java.util.HashMap<Beer, Integer> recommendationMap;

rule "recommend by logger"
agenda-group "beerCep"
    when
        $user: User()
        $beer: Beer()
        Number(intValue > 4) from accumulate (
            UserBeerLogger(user.getId() == $user.getId(), $beer == beer)
            over window: time(5d), count($beer)
        )
    then
        recommendationMap.put($beer, recommendationMap.getOrDefault($beer, 0) + 1);
end
